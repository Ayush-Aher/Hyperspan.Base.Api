name: FTP to server

on:
  workflow_call:
    inputs:
      environmentName:
        required: true
        type: string

jobs:
  ftp:
    runs-on: ubuntu-latest
    environment: ${{ inputs.environmentName }}

    steps:
      - name: Get latest code
        uses: actions/checkout@v3

      - name: Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: 6.0.x

      - name: Publish
        run: dotnet publish --configuration Release --output ${{secrets.LOCALPATH}}
        
      - name: ftp-action
        uses: sebastianpopp/ftp-action@v2.0.0
        with:
          host: ${{secrets.SERVER_IP}}
          user: ${{secrets.USERNAME}}
          password: ${{secrets.PASSWORD}}
          localDir: ${{secrets.LOCALPATH}}
          remoteDir: ${{secrets.REMOTEPATH}}
